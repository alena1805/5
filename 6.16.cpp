#include <iostream>   // Для ввода-вывода
#include <fstream>    // Для работы с файлами
#include <string>     // Для работы со строками
#include <cctype>     // Для функций проверки символов (например, isalpha)

using namespace std;  // Используем стандартное пространство имен

// Функция для обработки строк из входного файла и записи их в выходной файл
void as(const string& inF, const string& outF, char l) {
    ifstream inFile(inF);  // Открываем файл для чтения
    ofstream outFile(outF); // Открываем файл для записи

    // Проверка на успешное открытие входного файла
    if (!inFile) {
        cerr << "Ошибка при открытии файла для чтения." << endl; // Вывод сообщения об ошибке
        return; // Завершаем выполнение функции, если файл не открыт
    }

    // Проверка, что входной файл не пуст
    inFile.seekg(0, ios::end); // Перемещаем указатель в конец файла
    if (inFile.tellg() == 0) { // Проверяем позицию указателя (если он в начале, файл пуст)
        cout << "Входной файл пуст." << endl; // Сообщение о пустом файле
        return; // Завершаем выполнение функции
    }
    inFile.seekg(0, ios::beg); // Перемещаем указатель обратно в начало файла

    // Проверка на успешное открытие выходного файла
    if (!outFile) {
        cerr << "Ошибка при открытии файла для записи." << endl; // Вывод сообщения об ошибке
        return; // Завершаем выполнение функции, если файл не открыт
    }

    string line; // Переменная для хранения текущей строки
    bool isWritten = false;  // Флаг для проверки, были ли записаны строки в выходной файл

    // Чтение строк из исходного файла
    while (getline(inFile, line)) { // Читаем строки до конца файла
        // Проверка, чтобы строка была достаточной длины и начиналась или содержала заданную букву
        if (line.length() > 1 && (tolower(line[0]) == tolower(l) || tolower(line[1]) == tolower(l))) {
            outFile << line << endl;  // Записываем строку в выходной файл
            isWritten = true;  // Устанавливаем флаг в true, если строка записана
        }
    }

    // Если ни одна строка не была записана, выводим сообщение
    if (!isWritten) {
        cout << "Нет строк, удовлетворяющих условию." << endl; // Сообщение о том, что нет подходящих строк
    }

    inFile.close();   // Закрываем файл для чтения
    outFile.close();  // Закрываем файл для записи
}

int main() {
    const string inF = "input.txt";  // Имя входного файла
    const string outF = "output.txt"; // Имя выходного файла

    char l; // Переменная для хранения введенной буквы
    cout << "Введите букву для поиска: "; // Запрос на ввод буквы
    cin >> l; // Чтение введенной буквы

    // Проверяем, что введенная буква — это символ
    if (!isalpha(l)) { // Проверка на то, является ли введенный символ буквой
        cout << "Ошибка! Введите действительную букву." << endl; // Сообщение об ошибке при некорректном вводе
        return 1; // Завершение программы с кодом ошибки 1
    }

    // Обрабатываем файл: ищем строки, содержащие введенную букву
    as(inF, outF, l);

    cout << "Обработка завершена." << endl; // Сообщение о завершении обработки

    return 0; // Завершение программы с кодом 0 (успешно)
}
